%
   function [ q, r ] = orth_dcgs2_qr( Q, R )
%  
      m = size(Q,1);
      j = size(Q,2); 
%
      r = zeros(j-1,2);
      q = zeros(m,2);
%
      if ( j == 2 ),
%
         r(1,1) = Q(1:m,1)' * Q(1:m,1);
         r(1,2) = Q(1:m,1)' * Q(1:m,2); 
%
         r(1,1) = sqrt( r(1,1) );  
         r(1,2) = r(1,2) / r(1,1);  
%
         q(1:m,1) = Q(1:m,1) / r(1,1); 
         q(1:m,2) = Q(1:m,2) - q(1:m,1) * r(1,2); 
%
      end
%
      if ( j >= 3 ),
%
         tmp(1:j-1,1:2) = Q(1:m,1:j-1)' * Q(1:m,j-1:j);
%
         work(1:j-2,1) = tmp(1:j-2,1);
         r(1:j-1,2)    = tmp(1:j-1,2);
         r(j-1,1)      = tmp(j-1,1);
%
         r(j-1,2) = r(j-1,2) - work(1:j-2,1)' * r(1:j-2,2);
         r(j-1,1) = r(j-1,1) - work(1:j-2,1)' * work(1:j-2,1); 
         r(1:j-2,1) = R(1:j-2,1) + work(1:j-2,1); 
         r(j-1,1) = sqrt( r(j-1,1) );
         r(j-1,2) = r(j-1,2) / r(j-1,1);
%
         Q(1:m,j-1) = Q(1:m,j-1) - Q(1:m,1:j-2) * work(1:j-2,1); 
         Q(1:m,j) = Q(1:m,j) - Q(1:m,1:j-2) * r(1:j-2,2);
%
         q(1:m,1) = Q(1:m,j-1) / r(j-1,1);
         q(1:m,2) = Q(1:m,j) - q(1:m,1) * r(j-1,2);
%
      end
%
   end 





